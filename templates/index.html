<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ferramenta de Adequação de PDF | Lauro de Freitas</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.min.js"></script>
    <link rel="stylesheet" href="static/css/style.css">

</head>
<body>

<nav class="navbar mb-4">
    <div class="container text-center text-md-start">
        <a href="/" class="logo-wrapper">
            <img src="https://laurodefreitas.ba.gov.br/site/LogoLauro_Horizontal1.jpg" alt="Logo Lauro de Freitas">
        </a>
    </div>
</nav>

<div id="progressOverlay">
    <div class="spinner-grow text-primary mb-4" role="status"></div>
    <h3 id="statusText" class="fw-bold">Processando Documento</h3>
    
    <div class="progress mt-3" style="width: 350px; height: 10px; border-radius: 20px; background: rgba(255,255,255,0.1);">
        <div id="progressBar" class="progress-bar bg-primary" role="progressbar" style="width: 0%"></div>
    </div>

    <div id="logConsole" class="mt-4 p-3 shadow-inner" style="width: 80%; max-width: 600px; height: 150px; background: rgba(0,0,0,0.5); border-radius: 8px; font-family: 'Courier New', monospace; font-size: 0.8rem; overflow-y: auto; border: 1px solid rgba(255,255,255,0.1); text-align: left;">
        <div class="text-success small mb-1">> Aguardando logs do servidor...</div>
    </div>
    
    <p class="text-white-50 mt-3 small">Otimizando via Ghostscript & OCR</p>
</div>

<div class="container pb-5">
    <div class="stats-bar d-flex justify-content-between align-items-center">
        <div class="d-flex gap-4">
            <div>
                <span class="text-white-50 d-block small mb-1" style="font-size: 0.65rem; text-transform: uppercase;">Original</span>
                <span class="fw-bold" id="origSize">0.00</span> <small>MB</small>
            </div>
            <div class="vr opacity-25"></div>
            <div>
                <span class="text-white-50 d-block small mb-1" style="font-size: 0.65rem; text-transform: uppercase;">Estimado</span>
                <span class="fw-bold text-primary" id="estSize">0.00</span> <small>MB</small>
            </div>
        </div>
        <div class="d-flex align-items-center gap-3">
            <span class="badge bg-primary rounded-pill">-<span id="reduction">0</span>%</span>
            <button id="btnClear" class="btn btn-secondary shadow-sm">Limpar</button>
            <button form="mainForm" type="submit" id="btnDownload" class="btn btn-success shadow-sm" disabled>OTIMIZAR AGORA</button>
        </div>
    </div>

    <div class="card p-4 mb-4 border-0 shadow-sm" style="border-radius: 16px;">
        <div class="row align-items-center">
            <div class="col-lg-4">
                <div class="drop-zone rounded-4 p-4 text-center" id="dropZone">
                    <svg width="40" height="40" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" class="mb-2">
                        <path d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
                    </svg>
                    <p class="mb-0 small fw-bold text-muted" id="dropText">Arraste o PDF aqui ou clique</p>
                    <input type="file" id="pdfInput" class="d-none" accept=".pdf">
                </div>
            </div>
            <div class="col-lg-8 text-lg-end mt-4 mt-lg-0">
    <label class="text-muted small d-block mb-1 fw-bold" style="letter-spacing: 1px; opacity: 0.6;">
        CONFIGURAÇÃO GLOBAL
    </label>
    <p class="small text-muted mb-3">Selecione para aplicar o mesmo nível de compressão em todo o documento</p>

    <div class="d-flex flex-wrap justify-content-lg-end gap-2">
        <div class="btn-group shadow-sm" role="group" aria-label="Níveis de DPI">
            <button type="button" class="btn btn-outline-secondary btn-sm px-3" onclick="bulkApply(1)" title="Mantém alta fidelidade">Padrão</button>
            <button type="button" class="btn btn-outline-secondary btn-sm px-3" onclick="bulkApply(2)" title="Alta Qualidade">HQ</button>
            <button type="button" class="btn btn-outline-secondary btn-sm px-3" onclick="bulkApply(3)">150 DPI</button>
            <button type="button" class="btn btn-outline-secondary btn-sm px-3" onclick="bulkApply(4)">72 DPI</button>
            <button type="button" class="btn btn-outline-secondary btn-sm px-3" onclick="bulkApply(5)">50 DPI</button>
        </div>

        <button type="button" class="btn btn-dark btn-sm px-4 shadow-sm fw-bold" onclick="bulkApply(6)" 
                style="background: var(--dark); border-radius: 8px;">
            <svg width="14" height="14" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" class="me-1">
                <path d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v6m-3-3h6"></path>
            </svg>
            OCR + DIVIDIR
        </button>
    </div>
</div>
    </div>

    <form id="mainForm" method="post" enctype="multipart/form-data">
        <input type="file" name="pdf" id="hiddenFile" style="display:none">
        <input type="hidden" name="config_map" id="configMapInput">
        <div id="previewArea" class="preview-grid "></div>
    </form>
</div>

<footer class="footer mt-auto py-3 bg-light">
    <div class="container text-center">
        <span class="text-muted small">
            Sistema interno de processamento de documentos. Uso restrito à Prefeitura de Lauro de Freitas
        </span>
    </div>
</footer>

</body>
<script type="text/javascript" src="static/js/scripts.js"></script>
<script type="text/javascript" src="static/js/canvas-wrapper.js"></script>
</html>